---
title: "Next Generation Shiny Apps with bslib"
subtitle: R/Medicine 2024
author: Garrick Aden-Buie
format: 
  revealjs:
    theme: "slides.scss"
    highlight-style: github
---

# Welcome!

## Welcome! {.center}

üëã Hi, I'm Garrick!

üñ•Ô∏è [garrickadenbuie.com](https://garrickadenbuie.com)

ü¶¨ [grrrck@fosstodon.org](https://fosstodon.org/@grrrck)


## About our workshop

::: incremental
* 3 hours long with two breaks

* Break-out small groups for exercises

* Video, voice or chat

* Questions welcome! Use chat or raise your hand.
    * `*` at the start, I'll read it out loud

* ![](assets/slides-01/raise-hand-in-zoom.jpeg)
:::


## Code of Conduct

<https://rconsortium.github.io/RMedicine_website/Attend.html>

> **All event participants**, whether they are attending an in-person event or a virtual event, **are expected to behave in accordance with professional standards**, with both this Code of Conduct as well as their respective employer‚Äôs policies governing appropriate workplace behavior and applicable laws.

Report issues to me in private chat or during breakout sessions.

## {.light background-image="assets/slides-01/alvaro-reyes-fSWOVc3e06w-unsplash.jpg" background-position="bottom center"}

::: {style="font-size:1.5em; position:absolute; bottom: 0;"}
Breakout Sessions <br> Pair Programming
:::

## Pair Programming 

::: {.incremental}
* **Driver**: share your screen, writes code

* **Navigator**: review, guide, look up

* Video on encouraged

* We'll shuffle breakout groups each hour
:::


# Hello, bslib!

## ![Shiny logo](assets/slides-01/shiny.svg){style="max-width:50%"} {.center style="text-align: center"}

::: notes
In the beginning there was Shiny
:::

## ![Bootstrap logo](assets/slides-01/bootstrap-logo.svg){style="max-width:50%"} {.center style="text-align: center"}

::: notes
Actually, before Shiny there was a web framework from a little startup called Twitter: Bootstrap
:::

## Timeline: Bootstrap + Shiny

::: incremental
* Created by Twitter, Bootstrap is released in 2011.

* Joe Cheng unveils Shiny in 2012

* Bootstrap releases v3 in August 2013, a complete re-write.

* Shiny [moves to Bootstrap 3](https://github.com/rstudio/shiny/pull/611) in October 2014.

*

*

*

* Shiny still uses Bootstrap 3.
:::

## Shiny

```{.r}
numericInput(
  inputId = "academic_year",
  label = "Academic Year (start)",
  value = 2012, 
  min = 1996, 
  max = 2022, 
  step = 1
)
```

```{r}
#| output: false
rescale_page <- function(..., scale = 1) {
    htmltools::tagList(
        htmltools::tags$style(
            sprintf("html {
                transform: scale(%d);
                transform-origin: top left;
            }", scale),
            "body { padding: 1em; }"
        ),
        ...
    )
}

save_standalone <- function(html, path) {
    htmltools::save_html(html, path)

    # Remove leading doctype
    lines <- readLines(path)
    writeLines(lines[-1], path)

    withr::with_dir(
        dirname(path),
        pandoc::pandoc_convert(
            file = basename(path),
            output = basename(path),
            standalone = FALSE,
            to = "html",
            args = c("--embed-resources=true", "--resource-path=lib")
        )
    )

    invisible(path)
}

ni <- shiny::numericInput(
  inputId = "academic_year",
  label = "Academic Year (start)",
  value = 2012, 
  min = 1996, 
  max = 2022, 
  step = 1,
  width = "300px"
)

ni |>
    rescale_page() |>
    save_standalone("assets/slides-01/numeric_input.html")
```

## In the browser

### Raw HTML

```{.html}
<div>
  <label id="academic_year-label" for="academic_year">Academic Year (start)</label>
  <input id="academic_year" type="number" value="2012" min="1996" max="2022" step="1"/>
</div>
```

::: {.fragment style="margin-top:1em;"}
### looks like this

```{=html}
<iframe src="assets/slides-01/numeric_input.html" style="transform: scale(2); transform-origin: top left" width="50%"></iframe>
```
:::

## With Bootstrap

```{r}
ni |>
    rescale_page() |>
    shiny::bootstrapPage() |>
    save_standalone("assets/slides-01/numeric_input_bootstrap.html")
```

### the same HTML

```{.html}
<div class="form-group shiny-input-container">
  <label class="control-label" id="academic_year-label" for="academic_year">Academic Year (start)</label>
  <input id="academic_year" type="number" class="shiny-input-number form-control" value="2012" min="1996" max="2022" step="1"/>
</div>
```

::: {.fragment}
### looks like this

```{=html}
<iframe src="assets/slides-01/numeric_input_bootstrap.html" style="transform: scale(2); transform-origin: top left"  style="transform: scale(2); transform-origin: top left" width="50%"></iframe>
```
:::

## Bootstrap Versions

```{r}
ni |>
    rescale_page() |>
    shiny::bootstrapPage(theme = bslib::bs_theme(5, "default")) |>
    save_standalone("assets/slides-01/numeric_input_bslib_5.html")
```

### Bootstrap 3

```{=html}
<iframe src="assets/slides-01/numeric_input_bootstrap.html"  style="transform: scale(2); transform-origin: top left" width="50%"></iframe>
```

### Bootstrap 5 {style="z-index: 10; position: relative;"}

```{=html}
<iframe src="assets/slides-01/numeric_input_bslib_5.html"  style="transform: scale(2); transform-origin: top left" width="50%"></iframe>
```

## How bslib started

* New and improved Bootstrap 4 and 5

* Easy theming in any web output from R

::: fragment
```{.r}
library(shiny)

fluidPage(
  theme = bslib::bs_theme(version = 5),
  # the rest of your app, unchanged
)
```
:::

## bslib::bs_theme()

```{.r}
theme = bslib::bs_theme(version = 5, preset = "bootstrap")
```

```{=html}
<iframe src="assets/slides-01/numeric_input_bslib_5.html" style="transform: scale(2); transform-origin: top left" width="50%"></iframe>
```

## bslib::bs_theme()

```{.r}
theme = bslib::bs_theme(version = 5, preset = "darkly")
```

```{r}
ni |>
    rescale_page() |>
    shiny::bootstrapPage(theme = bslib::bs_theme(5, "darkly")) |>
    save_standalone("assets/slides-01/numeric_input_bslib_5_darkly.html")
```

```{=html}
<iframe src="assets/slides-01/numeric_input_bslib_5_darkly.html" style="transform: scale(2); transform-origin: top left" width="50%"></iframe>
```

## bslib::bs_theme(preset = "shiny")

```{.r}
theme = bslib::bs_theme(version = 5, preset = "shiny")
```

```{r}
ni |>
    rescale_page() |>
    shiny::bootstrapPage(theme = bslib::bs_theme(5, "shiny")) |>
    save_standalone("assets/slides-01/numeric_input_bslib_5_shiny.html")
```

```{=html}
<iframe src="assets/slides-01/numeric_input_bslib_5_shiny.html" style="transform: scale(2); transform-origin: top left" width="50%"></iframe>
```

## Theming from start to advanced

```{.r code-line-numbers="|3|4-5|6-7"}
fluidPage(
  theme = bslib::bs_theme(
    preset = "shiny",
    primary = "#0072B2",
    success = "#009E73",
    base_font = font_google("Inter"),
    code_font = font_google("JetBrains Mono")
  )
)
```


::: fragment
* bslib rebuilds Bootstrap's Sass to CSS from scratch

* [Get Started: Theming](https://rstudio.github.io/bslib/articles/theming/index.html)

* [Theming: Bootstrap 5 variables](https://rstudio.github.io/bslib/articles/bs5-variables/index.html)
:::

## fluidPage() {transition="fade" transition-speed="slow"}

```{.r}
library(shiny)

shiny::fluidPage(
  theme = bslib::bs_theme(version = 5),
  # the rest of your app, unchanged
)
```

## fluidPage() &rarr; page_fluid() {transition="fade" transition-speed="slow"}

```{.r}
library(shiny)
library(bslib)

page_fluid(
  # the rest of your app, unchanged
)
```

# Your Turn

## College Scorecard Data {.center}

<https://collegescorecard.ed.gov/data/>

College enrollment, student aid, costs, and student outcomes from 1996-97 through 2022-23.

Two tables:

1. `school`: information about each college

2. `scorecard`: historical data on cost, enrollment, outcomes.

::: footer
<https://github.com/gadenbuie/scorecard-db>
:::

## Your Turn: `exercises/01_app.R`

**Are we all set up?**

- Help each other make sure you're set up

**Take a Shiny app and make it bslib-ier**

- From `{type}Page()` to `page_{type}()`
- What other page types are available?
- Try out Bootsrap/Bootswatch themes
- _Extra points: try a Sass variable_

**Use the app to learn about the variables in `school`**

## Check-in

Any troubles getting set up?

Questions about bslib or the data set?

## Bonus: Let's update our Shiny snippet

```
snippet shinyapp
    library(shiny)
    library(bslib)

    ui <- page_${1:sidebar}(
      ${0}
    )

    server <- function(input, output, session) {

    }

    shinyApp(ui, server)
```

::: footer
<https://www.garrickadenbuie.com/blog/shiny-new-bslib-snippet/>
:::


```{r}
unlink("assets/slides-01/lib", recursive = TRUE)
```